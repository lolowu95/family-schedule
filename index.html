<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>家庭日程管理</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <!-- Firebase SDK 引入（使用 compat 模式） -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
</head>
<body>
    <!-- 加载提示 -->
    <div id="loading" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 9999;">
        <p style="color: white; font-size: 1.5em;">加载中...</p>
    </div>

    <!-- 密码验证界面 -->
    <div class="password-container" id="passwordContainer">
        <div class="form-group">
            <label><i class="fas fa-lock"></i> 请输入访问密码</label>
            <input type="password" id="accessPassword" placeholder="请输入密码" required autofocus>
            <div class="error-message" id="passwordError">密码错误，请重试！</div>
        </div>
        <button id="verifyButton"><i class="fas fa-sign-in-alt"></i> 验证</button>
    </div>

    <!-- 登录界面 -->
    <div class="login-container" id="loginContainer" style="display: none;">
        <div class="form-group">
            <label><i class="fas fa-user"></i> 选择用户</label>
            <select id="username" autofocus>
                <option value="" disabled selected>请选择</option>
                <option value="吴乐乐">吴乐乐</option>
                <option value="冯妈妈">冯妈妈</option>
                <option value="张宝宝">张宝宝</option>
                <option value="懒宝">懒宝</option>
            </select>
        </div>
        <button id="loginButton"><i class="fas fa-sign-in-alt"></i> 登录</button>
    </div>

    <!-- 日程管理界面 -->
    <div id="scheduleForm" style="display: none;">
        <button id="logoutButton" style="display: none;"><i class="fas fa-sign-out-alt"></i> 登出</button>
        <h2>添加日程</h2>
        <div class="form-group">
            <label><i class="fas fa-calendar-alt"></i> 日期范围</label>
            <input type="text" id="datetimeDisplay" readonly>
            <button id="openDatePickerButton"><i class="fas fa-calendar"></i> 选择日期</button>
        </div>
        <div class="form-group">
            <label><i class="fas fa-tasks"></i> 事件</label>
            <input type="text" id="event" placeholder="请输入事件">
        </div>
        <button id="addScheduleButton"><i class="fas fa-plus"></i> 添加</button>
    </div>

    <!-- 日期选择模态框 -->
    <div id="datePickerModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3 id="modalCalendarMonth"></h3>
            <button id="prevModalMonthButton"><i class="fas fa-chevron-left"></i></button>
            <button id="nextModalMonthButton"><i class="fas fa-chevron-right"></i></button>
            <div id="modalCalendarGrid" class="calendar-grid"></div>
            <button id="cancelDatePickerButton">取消</button>
            <button id="confirmRangeButton">确认</button>
        </div>
    </div>

    <!-- 日程列表 -->
    <div id="scheduleList" style="display: none;">
        <h2>日程列表</h2>
        <div class="form-group">
            <label>筛选用户</label>
            <select id="filterUser">
                <option value="">全部</option>
                <option value="吴乐乐">吴乐乐</option>
                <option value="冯妈妈">冯妈妈</option>
                <option value="张宝宝">张宝宝</option>
                <option value="懒宝">懒宝</option>
            </select>
        </div>
        <div class="view-toggle">
            <button id="calendarViewBtn" class="active">日历视图</button>
            <button id="timelineViewBtn">时间线视图</button>
        </div>
        <div id="calendarView">
            <div class="calendar-header">
                <button id="prevMonthButton"><i class="fas fa-chevron-left"></i></button>
                <h3 id="calendarMonth"></h3>
                <button id="nextMonthButton"><i class="fas fa-chevron-right"></i></button>
            </div>
            <div id="calendarGrid" class="calendar-grid"></div>
        </div>
        <div id="timelineView" style="display: none;"></div>
    </div>

    <!-- 日志列表 -->
    <div id="logList" style="display: none;">
        <h2>操作日志</h2>
        <div id="logs"></div>
    </div>

    <!-- 引入 JavaScript 文件 -->
    <script src="js/firebase.js" type="module"></script>
    <script src="js/auth.js" type="module"></script>
    <script src="js/schedule.js" type="module"></script>
    <script src="js/calendar.js" type="module"></script>
    <script src="js/main.js" type="module"></script>
</body>
</html>
